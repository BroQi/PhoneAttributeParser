<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>号码归属地解析</title>
<script type="text/javascript" src="resources/plugin/jquery.js"></script>
<script type="text/javascript" src="resources/plugin/layer/layer.js"></script>
<style type="text/css">
* {
	margin: 0;
	padding: 0;
	font-size: 14px;
}

body {
	width: 100%;
	height: 100%;
}

.foot {
	position: absolute;
	bottom: 0;
	height: 60px;
	text-align: center;
	font-size: 16px;
	background-color: grey;
	width: 100%;
	line-height: 60px;
	font-style: italic;
	font-family: '幼圆';
}
</style>
</head>
<body>
	<div>
		<form id="frm_upload" method="post" enctype="multipart/form-data">
			<input type="file" name="file" value="选择excel文件"> <input
				type="button" value="查询" onclick="uploadExcel()" />
		</form>

		<div>
			<h1>提示：</h1>
			<p>
				上传需要解析归属地的EXCEL文件进行解析，<a href="parse/download/模板.xlsx">点此</a>下载模板文件
			</p>
		</div>
	</div>
	<div class="foot">
		<p>DESIGN & DEVLOP BY 乱来</p>
	</div>

	<script type="text/javascript">
		function uploadExcel() {
			var loadIndex = layer.load();
			var value = $("input[name='file']").val();
			if (value == null || value == "") {
				layer.close(loadIndex);
				layer.msg("不选择文件，你解析个屁啊");
				return;
			}
			var formData = new FormData();
			formData.append("file", $("input[name='file']")[0].files[0]);
			$.ajax({
				url : "parse",
				type : "POST",
				data : formData,
				// 告诉jQuery不要去处理发送的数据
				processData : false,
				// 告诉jQuery不要去设置Content-Type请求头
				contentType : false,
				complete : function() {
					layer.close(loadIndex);
				},
				success : function(data) {
					window.location.href = "parse/download/" + data.data;
				},
				error : function(data) {
					layer.alert("查询出错 ");
				}
			});
		}
	</script>
</body>
</html>